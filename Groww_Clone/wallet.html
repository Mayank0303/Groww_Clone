<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="wallet.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <title>Wallet</title>
</head>
<body>
    <!-- header -->
    <div class="head-container">
        <div class="header">
        
        <div class="logo-image">
            <a href="dashboard.html">
                <img src="//assets-netstorage.groww.in/website-assets/prod/1.8.1/build/client/images/logo-dark-groww.83f43714.svg" alt="Groww Logo">
            </a>
            </div>
        <div class="navbarOptions">
            <p>Explore</p>
            <p>Investments</p>
        </div>
        <!-- search bar and search icon  -->
        <div id="searchbar">
            <input type="search" id="search" placeholder="What are you looking for today?">
            <img class="searchIcon" src="https://assets-netstorage.groww.in/website-assets/prod/1.8.1/build/client/images/search.494f6987.svg">
        </div>
        <div class="icons">
            <img class="bell-icon" src="images/bell.png">
            <img class="wallet-icon" src="images/wallet.png">
            <img class="cart-icon" src="images/cart.png">
        </div>
        <div class="userIcon">
            User
            
        </div>
    </div>
</div>

<!-- Header End -->

<!-- Currency Options Start -->
<div class="currency-box">
    <div class="inr">
        INR Balance
    </div>
    <div class="usd">
        USD Balance
    </div>
</div>

<!-- Currency Options End -->

<!-- Balance Display Start -->

<div class="balance-cont">

    <div class="balance-box">
        <div class="balance-text">
                Balance Available

            <div class="available-balance">0</div>
        </div>
    </div>
    <div class="balance-details">
        <div class="details-box">
            <div class="details">
                Details
            </div>
            <div class="all-details">

                <div class="cb">
                    Closing Balance (CB) : <span class="cd-1">	&#8377;</span><p>0.00</p>
                    
                </div>
                <div class="ot">
                    Ongoing Transactions : <span class="ot-1">	&#8377;</span><p>0.00</p>
                </div>
                <div class="ba">
                    Balance Available : <span class="ba-1">&#8377;</span><p>0.00</p>
                    
                </div>
            </div>
        </div>
    </div>
</div>

<div class="add-money-container">
    <div class="add-money__box">
        <div class="deposit" onclick="deposit()" >
            Deposit
        </div>
        <div class="withdraw" onclick="withdraw()">
            withdraw
        </div>
    </div>
    <div class="deposit-options">

        <label for="money">Enter Amount
            <input type="number" id="money" placeholder="0" required>
        </label>
        <div class="money-options">
            <div class="1thousand">+ &#8377; 1,000</div>
            <div class="5thousand">+ &#8377; 5,000</div>
        </div>
        <button class="deposit-button btn-color" onclick="depositmoney()">DEPSOIT MONEY</button>
    </div>

    <div class="withdraw-options">
        <div class="withdrawable">
            withdrawable <span class="faq">&quest;</span>
            <div class="show-total__amount"> &#8377; <span class="show-amount"></span></div>
        </div>
        <label class="withdraw-amount" for="withdraw-money">Enter Amount
            <input type="number" id="withdraw-money" placeholder="0" required>
        </label>
        <div class="withdraw-all">
            <label for="withdraw-all__checkbox">
                <input type="checkbox" id="withdraw-all__checkbox">
                Withdraw All

            </label>
        </div>
        <div class="withdraw-to">
            <div class="bank-name">
                To
                <span>
                    ICICI BANK LIMITED
                </span>
            </div>

        </div>
        <button class="withdraw-money__button btn-color" onclick="withdrawmoney()">Withdraw MONEY</button>
    </div>
</div>

<script>
        function deposit() {
            let options = document.querySelector('.deposit-options');
            const withdrawOptions = document.querySelector('.withdraw-options')
            options.style.visibility = 'hidden';
            withdrawOptions.style.visibility = 'visible';
            console.log("Hai");
        }
        deposit()
    
    function depositmoney() {
        let amount = document.getElementById('money').value;
        console.log('amount:', (amount));
        const toNumber = Number(amount);
        addBalance(toNumber);
    }

    
    let newAmount = JSON.parse(localStorage.getItem('balance'));
    var balance = newAmount;

    // controller

    function addBalance(amount) {
        balance += amount;
        localStorage.setItem('balance', balance.toString());
        
        render();
    }

    // view
    const availableBalanceDiv = document.querySelector(".available-balance");

    function render() {
    availableBalanceDiv.innerText = balance.toLocaleString();
    }
    render();



//withdraw amount function

// accessing the totalbalnce from the localstorage
    let totalAmount = JSON.parse(localStorage.getItem('balance'));
    console.log('totalAmount:', totalAmount)

function withdraw() {
    console.log("hai");

    //creating all the variables and assing the values to it
    const disapper = document.querySelector('.deposit-options');
    const withdrawOptions = document.querySelector('.withdraw-options')
    const displayTotalMoney = document.querySelector('.show-amount');
    const enteredAmount = document.getElementById('withdraw-money')
    const withdrawAll = document.getElementById('withdraw-all__checkbox');
    const withdrawMoneyButton = document.querySelector('.withdraw-money__button');
    // console.log('enteredAmount:', enteredAmount)

    
    displayTotalMoney.innerText = totalAmount;

    //making eveyything to  be disable if wallet got 0
    if(totalAmount <= 0) {
        alert("You don't have sufficent amount to withdraw");
        enteredAmount.style.cursor = 'not-allowed';
        withdrawAll.style.cursor = 'not-allowed';
        enteredAmount.disabled = true;
        withdrawAll.disabled = true;
        withdrawMoneyButton.disabled = true;

    }
    
    // disapper.innerText = '';
    disapper.style.visibility = 'hidden';
    withdrawOptions.style.visibility = 'visible';


    
}

function withdrawmoney() {
    console.log('totalAmount:', totalAmount)
    const enteredAmount = document.getElementById('withdraw-money').value;
    
    console.log('enteredAmount:', enteredAmount)
    
    //checking wheter enteredAmount is greater then the wallet balance
    let remainingBalance = 0 ;

    //if user enteredAmount is zero or null
    if(enteredAmount == null || enteredAmount == 0) {
        alert('Please enter valid amount to withdraw');
    }
    else if(totalAmount < enteredAmount) {
        alert("You don't have enough funds to withdraw")
    } else {
        remainingBalance = totalAmount - enteredAmount
    }
    
    let remainingBalanceJson = JSON.stringify(remainingBalance);
    localStorage.setItem('balance',remainingBalanceJson);

    
    
    let availableBalanceDiv = document.querySelector(".available-balance")
    availableBalanceDiv.innerHTML = remainingBalanceJson;
    console.log('availableBalanceDiv:', availableBalanceDiv);
    }



    //Declearing the variables for the dropDownMenu
let userMenu = document.querySelector('.userIcon');
const menuDiv = document.createElement('div');
let darkMode = document.createElement('div');
const name = document.createElement('div');
const email = document.createElement('div');
const importFunds = document.createElement('div');
const watchList = document.createElement('div');
const orders = document.createElement('div');
const help = document.createElement('div');
const logOut = document.createElement('div');
const close = document.createElement('span');

//creting classes for the above variables
menuDiv.classList.add('menu')
darkMode.classList.add('darkModeOn')
importFunds.classList.add('importFunds')



    function dropDownMenu() {
        
        let count = 0;
        importFunds.innerHTML = "Import Funds";
        watchList.innerHTML = "Watch List";
        orders.innerHTML = "Order";
        darkMode.innerHTML = "Dark Mode";
        logOut.innerHTML = "Log Out";
        close.innerHTML = "close&times;";

        //Cretaing a class for menuDiv
        
        menuDiv.classList.add('content');

        //appending all the items to the menuDiv

        menuDiv.append(close,importFunds,watchList,orders,darkMode,logOut);

        //appending the items of the menuDiv to the userMenu
        userMenu.append(menuDiv);

        close.onclick = function() {
            menuDiv.style.display = "none";
          }

        count++;

        if (count >= 1) {
            userMenu.removeEventListener('click', dropDownMenu);
        }
        
    }
    // c.classList.add('baby')


    
    function darkModeToggle() {
        let darkModeButton = document.querySelector('.darkModeOn');
        // let a = document.querySelector('.stock-name')
        // let b = document.querySelector('.menu')
        // a.style.color = 'white'
        // b.style.color = 'black'
        darkModeButton = document.body;
         darkModeButton.classList.toggle('dark-mode');

        }

    userMenu.addEventListener('click', dropDownMenu);
    darkMode.addEventListener('click',darkModeToggle)


</script>
</body>
</html>


